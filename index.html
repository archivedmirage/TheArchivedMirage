<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Archived Mirage</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@400;600&family=UnifrakturMaguntia&display=swap" rel="stylesheet">
<style>
:root{--bg:#f6f6f7;--card:#ffffff;--text:#202223;--border:#e1e3e5;--primary:#000000;--glass:rgba(255,255,255,.55);}
body.dark{--bg:#0e0f11;--card:#16181c;--text:#eaeaea;--border:#2a2d33;--glass:rgba(20,20,25,.55);}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui;background:var(--bg);color:var(--text);overflow-x:hidden;transition:.3s;}
.brand-font {font-family: 'UnifrakturMaguntia', cursive; font-size: 1.5rem; letter-spacing: 1px;}
h1, h2, h3 { font-family: "Playfair Display", serif; }
.intro-screen{position:fixed;inset:0;background:var(--bg);display:flex;align-items:center;justify-content:center;z-index:9999;animation:introHide 3s forwards;}
.intro-glass{padding:60px 70px;border-radius:28px;background:var(--glass);backdrop-filter:blur(20px);border:1px solid var(--border);text-align:center;animation:introReveal 1.3s ease forwards;}
@keyframes introReveal{from{opacity:0;transform:scale(.92)}to{opacity:1}}
@keyframes introHide{100%{opacity:0;visibility:hidden}}
header{background:var(--card);border-bottom:1px solid var(--border);padding:14px 20px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:5;}
nav a{margin-left:16px;cursor:pointer; font-weight: 500;}
.badge{background:red;color:#fff;border-radius:50%;padding:2px 7px;font-size:12px;animation:pulse 1.2s infinite}
@keyframes pulse{50%{transform:scale(1.2)}}
.theme-toggle{margin-left:12px;backdrop-filter:blur(10px);background:var(--glass);border:1px solid var(--border);padding:6px 14px;border-radius:999px;cursor:pointer;}
section{position:absolute;width:100%;min-height:calc(100vh - 70px);padding:26px;left:100%;transition:.45s cubic-bezier(.4,0,.2,1);}
section.active{transform:translateX(-100%)}
section.previous{transform:translateX(-200%)}
.hero{background:var(--card);padding:80px 50px;border-radius:26px;text-align:center;max-width:900px;margin:40px auto;animation:introHero .8s ease forwards;opacity:0;}
@keyframes introHero{to{opacity:1;transform:translateY(0)}}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:22px;}
.product{background:var(--card);border:1px solid var(--border);border-radius:18px;overflow:hidden;transition:.3s;}
.product:hover{transform:translateY(-6px)}
.product img{width:100%;height:220px;object-fit:cover}
.info{padding:14px}
button{background:var(--primary);color:#fff;border:none;padding:11px;border-radius:10px;font-weight:600;width:100%;cursor:pointer;margin-top:6px;}
input{width:100%;padding:12px;margin-bottom:12px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--text);}
#cartOverlay{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;z-index:9;}
#cartDrawer{position:fixed;top:0;right:-360px;width:340px;height:100%;background:var(--card);padding:20px;transition:.35s;z-index:10;overflow:auto;}
#loginOverlay {position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(8px); display: none; align-items: center; justify-content: center; z-index: 10000;}
.login-box {background: var(--card); border: 1px solid var(--border); padding: 30px; border-radius: 20px; width: 90%; max-width: 320px; text-align: center;}
.admin-box {background: var(--card); border: 1px solid var(--border); padding: 15px; border-radius: 12px; margin-bottom: 15px;}
</style>
</head>
<body>

<div class="intro-screen"><div class="intro-glass"><h1 class="brand-font">The Archived Mirage</h1><p>Real Authentic Products</p></div></div>

<div id="loginOverlay">
  <div class="login-box">
    <h3>Admin Access</h3>
    <input type="password" id="adminPassInput" placeholder="Password" onkeypress="if(event.key==='Enter') checkLogin()">
    <div style="display:flex; gap:10px;"><button onclick="checkLogin()">Login</button><button onclick="closeLogin()" style="background:#666">Cancel</button></div>
  </div>
</div>

<header>
<strong class="brand-font" onclick="go('home')" style="cursor:pointer">The Archived Mirage</strong>
<nav>
<a onclick="go('home')">Home</a><a onclick="go('store')">Store</a><a onclick="go('contact')">Contact</a><a onclick="adminLogin()">Admin</a>
<a onclick="openCart()">ðŸ›’ <span class="badge" id="cartCount">0</span></a>
<span class="theme-toggle" onclick="toggleTheme()">â˜€/ðŸŒ™</span>
</nav>
</header>

<section id="home" class="active">
<div class="hero"><h1 class="brand-font">The Archived Mirage</h1><p style="letter-spacing:2px; text-transform:uppercase;">Real Authentic Products</p><button onclick="go('store')" style="max-width:240px;margin:20px auto">Enter Store</button></div>
</section>

<section id="store"><div class="grid" id="products"></div></section>
<section id="contact"><h2>Contact</h2><p><strong>Phone:</strong> <span id="displayPhone"></span></p><p><strong>Email:</strong> <span id="displayEmail"></span></p></section>
<section id="checkout"><h2>Checkout</h2><input id="custName" placeholder="Full name"><input id="custPhone" placeholder="Phone"><input id="custAddress" placeholder="Address"><button onclick="placeOrder()">Order via WhatsApp</button></section>
<section id="admin"></section>

<div id="cartOverlay" onclick="closeCart()"></div>
<div id="cartDrawer"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, set, onValue, push, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

// Connection keys from your screenshots
const firebaseConfig = {
  apiKey: "AIzaSyDFLAL6I7ID_BY5weBVf6wx99jJXelhCH4",
  authDomain: "the-archived-mirage.firebaseapp.com",
  databaseURL: "https://the-archived-mirage-default-rtdb.firebaseio.com",
  projectId: "the-archived-mirage",
  storageBucket: "the-archived-mirage.firebasestorage.app",
  messagingSenderId: "615352427360",
  appId: "1:615352427360:web:dbebc6e1baac1b1742f405"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const productsRef = ref(db, 'products');
const contactRef = ref(db, 'contact');

let products = [];
let contact = { whatsapp: "971543108125", email: "nuaimshariff@gmail.com", displayPhone: "+971 0543108125" };
let cart = [];
let current = "home";
let isAdminLoggedIn = false;

// Cloud Sync
onValue(productsRef, (s) => { 
    const d = s.val(); 
    products = d ? Object.entries(d).map(([id, val]) => ({...val, fid: id})) : []; 
    renderProducts(); 
    if(isAdminLoggedIn) renderAdmin(); 
});
onValue(contactRef, (s) => { const d = s.val(); if(d) { contact = d; updateContactDisplay(); } });

function updateContactDisplay() { 
    if(document.getElementById("displayPhone")) document.getElementById("displayPhone").innerText = contact.displayPhone; 
    if(document.getElementById("displayEmail")) document.getElementById("displayEmail").innerText = contact.email; 
}

window.go = (id) => { 
    document.getElementById(current).classList.add("previous"); 
    document.getElementById(id).classList.add("active"); 
    document.getElementById(current).classList.remove("active"); 
    setTimeout(()=>document.getElementById(current).classList.remove("previous"),450); 
    current=id; closeCart(); 
};
window.toggleTheme = () => { document.body.classList.toggle("dark"); };
window.openCart = () => { document.getElementById("cartOverlay").style.display="block"; document.getElementById("cartDrawer").style.right="0"; };
window.closeCart = () => { document.getElementById("cartOverlay").style.display="none"; document.getElementById("cartDrawer").style.right="-360px"; };

function renderProducts() {
    const el = document.getElementById("products"); el.innerHTML = "";
    products.forEach(p => { 
        el.innerHTML += `<div class="product"><img src="${p.image}"><div class="info"><strong>${p.name}</strong><br>${p.price} AED<button onclick="addToCart('${p.fid}')">Add to Cart</button></div></div>`; 
    });
}

window.addToCart = (fid) => {
    const p = products.find(x => x.fid === fid);
    let item = cart.find(i => i.fid === fid);
    item ? item.qty++ : cart.push({...p, qty: 1}); renderCart();
};

function renderCart() {
    const d = document.getElementById("cartDrawer"); d.innerHTML = "<h3>Your Cart</h3>";
    let total = 0;
    cart.forEach((i) => { total += i.price * i.qty; d.innerHTML += `<div><strong>${i.name}</strong><br>${i.qty} x ${i.price} AED</div><hr>`; });
    d.innerHTML += `<strong>Total: ${total} AED</strong><br><br><button onclick="go('checkout')">Checkout</button>`;
    document.getElementById("cartCount").innerText = cart.reduce((a, b) => a + b.qty, 0);
}

window.placeOrder = () => {
    const n = document.getElementById("custName").value; const p = document.getElementById("custPhone").value; const a = document.getElementById("custAddress").value;
    if(!n || !p || !a) return alert("Fill all fields");
    let msg = `*New Order*%0A*Name:* ${n}%0A*Items:*%0A${cart.map(i=>`- ${i.name} x${i.qty}`).join('%0A')}`;
    window.open(`https://wa.me/${contact.whatsapp}?text=${msg}`, '_blank');
    cart = []; renderCart(); go('home');
};

window.adminLogin = () => { if(isAdminLoggedIn) renderAdmin(); else document.getElementById("loginOverlay").style.display="flex"; };
window.closeLogin = () => { document.getElementById("loginOverlay").style.display="none"; };
window.checkLogin = () => { if(document.getElementById("adminPassInput").value === "samariboys@buisness2026") { isAdminLoggedIn=true; closeLogin(); renderAdmin(); } else alert("Wrong"); };

function renderAdmin() {
    go("admin");
    let html = `<h2>Admin Panel</h2><button onclick="isAdminLoggedIn=false;go('home')">Logout</button><hr>
    <h3>Contact Info</h3>
    <div class="admin-box">
        <label>WhatsApp (971...)</label><input value="${contact.whatsapp}" onchange="updateContact('whatsapp', this.value)">
        <label>Display Phone</label><input value="${contact.displayPhone}" onchange="updateContact('displayPhone', this.value)">
        <label>Email</label><input value="${contact.email}" onchange="updateContact('email', this.value)">
    </div><hr>
    <h3>Products</h3><button onclick="addProduct()" style="background:green">+ Add New Product</button>`;
    products.forEach(p => {
        html += `<div class="admin-box">
            <input value="${p.name}" onchange="editProduct('${p.fid}', 'name', this.value)">
            <input type="number" value="${p.price}" onchange="editProduct('${p.fid}', 'price', this.value)">
            <input value="${p.image}" onchange="editProduct('${p.fid}', 'image', this.value)">
            <button onclick="deleteProduct('${p.fid}')" style="background:red">Delete</button>
        </div>`;
    });
    document.getElementById("admin").innerHTML = html;
}

window.updateContact = (k, v) => { contact[k] = v; set(contactRef, contact); };
window.addProduct = () => { push(productsRef, { name: "New Item", price: 0, image: "https://via.placeholder.com/400" }); };
window.editProduct = (fid, k, v) => { 
    const p = products.find(x => x.fid === fid); 
    p[k] = (k === 'price') ? Number(v) : v;
    const { fid: _, ...dataToSave } = p;
    set(ref(db, `products/${fid}`), dataToSave); 
};
window.deleteProduct = (fid) => { if(confirm("Delete?")) remove(ref(db, `products/${fid}`)); };

updateContactDisplay();
</script>
</body>
</html>
